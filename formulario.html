<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="css.min.css">
</head>

<body class="formularioLeads">
  <div class="modalRespuesta show" id="modalRespuesta"> <!-- class mostrar .show -->
    <div class="row">
      <div class="col-12 centrar">
        <div class="contenMSJ">
          <p class="mensaje">Su mensaje fue enviado con exito.</p>
          <button class="cerrar" alt="Cerrar" onclick="btnCerrarMSJ('.modalRespuesta')" type="button">
            <div class="close icon"></div>
          </button>
        </div>
      </div>
    </div>
  </div>


  <form action="" method="" id="agendamiento">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h2 class="mb-0">Agendamiento</h2>
        </div>
        <div class="col-4 mb-0">
          <div class="contentInput">
            <label for="nombre">
              *Nombre:
            </label>
            <div class="contentInputError">
              <input type="text" size="100" maxlength="100" data-nombre="false" name="" id="nombre" placeholder="Solo nombres."
                autocomplete="off">
            </div>
          </div>
        </div>
        <div class="col-4 mb-0">
          <div class="contentInput">
            <label for="apellido">
              *Apellido:
            </label>
            <div class="contentInputError">
              <input type="text" size="100" maxlength="100" data-apellido="false" name="" id="apellido" placeholder="Solo apellidos."
                autocomplete="off">
            </div>
          </div>
        </div>
        <div class="col-4 mb-0">
          <div class="contentInput">
            <label for="correo">
              *Correo:
            </label>
            <div class="contentInputError">
              <input type="text" name="" size="100" maxlength="100" data-correo="false" id="correo"
                placeholder="Correo personal o corporativo." autocomplete="off">
            </div>
          </div>
        </div>
        <div class="col-4 mb-0">
          <div class="contentInput">
            <label for="telefono">
              *Teléfono:
            </label>
            <div class="contentInputError">
              <input type="number" name="" size="20" maxlength="20" data-telefono="false" id="telefono"
                placeholder="Indicativo más número." autocomplete="off">
            </div>
          </div>
        </div>
        <div class="col-6 mb-0">
          <div class="contentInput">
            <label for="sector">
              *Sector:
            </label>
            <div class="contentInputError">
              <select id="sector" name="">
                <option disabled="" selected value="">Selecciona</option>
                <option value="Agentes de aduanas">Agentes de aduanas</option>
                <option value="Construcción">Construcción</option>
                <option value="Educativo">Educativo</option>
                <option value="Financiero">Financiero</option>
                <option value="Manufactura">Manufactura</option>
                <option value="Oil &amp; Gas">Oil &amp; Gas</option>
                <option value="Otros servicios">Otros servicios</option>
                <option value="Productos de consumo">Productos de consumo</option>
                <option value="Publicidad">Publicidad</option>
                <option value="Retail">Retail</option>
                <option value="Salud">Salud</option>
                <option value="Sector Público">Sector Público</option>
                <option value="Servicios jurídicos /contables">Servicios jurídicos /contables</option>
                <option value="Telecomunicaciones y tecnología">Telecomunicaciones y tecnología</option>
                <option value="Bancos">Bancos</option>
                <option value="Arte &amp; producciones">Arte &amp; producciones</option>
              </select>
            </div>
          </div>
        </div>
        <div class="col-12 mb-0">
          <div class="check">
            <label for="autorizo" class="contentInputError">
              <input id="autorizo" type="checkbox" name="" value="true">
              <p>Autorizo el contacto para fines comerciales, publicitarios y estadísticos por Whatsapp, cualquier
                medio análogo o digital a través de mi número celular, correo electrónico, mensajes de texto, entre
                otros, por parte de Legis</p>
            </label>
          </div>
        </div>

        <div class="col-12 mb-0">
          <div class="check">
            <label for="condiciones" class="contentInputError">
              <input id="condiciones" type="checkbox" name="" value="true">
              <p>*Acepto <a href="https://www.legis.com.co/terminosCondiciones" rel="noopener" target="_blank">términos
                  y condiciones</a> y <a href="https://www.privacidadlegis.com/" rel="noopener" target="_blank">política
                  de privacidad</a>*</p>
            </label>
          </div>
        </div>
        <div class="col-12">
          <div class="actions">
            <input type="submit" id="btn-enviar" class="btnSubmit" value="Enviar">
          </div>
        </div>
      </div>
    </div>
  </form>

  <script>
    // cerrar mensaje
    function btnCerrarMSJ(elm) {
      var btn = document.querySelector(elm);
      btn.classList.remove("show");
    }


    document.addEventListener("DOMContentLoaded", function () {
      document.getElementById("agendamiento").addEventListener('submit', validar);
    });

    function mostrarError(elem, mensaje) {
      // <label class="error">*Rellena este campo obligatorio.</label>
      if (!elem.parentElement.parentNode.querySelector(".error")) {
        let label = document.createElement("label");
        label.classList.add("error");
        label.id = "error_" + elem.id;
        label.innerHTML = mensaje;
        label.classList.add("show");
        elem.parentElement.parentNode.append(label);
      }
    }

    function borrarLabelError(event, campos, i) {
      let error = event.target.offsetParent.parentNode.lastChild;
      let elm = document.getElementById(error.id);
      if (elm) {
        elm.parentNode.removeChild(elm);
      }
    }

    let campos = document.querySelectorAll("[name]");
    if (campos) {
      for (let i = 0; i < campos.length; i++) {
        campos[i].addEventListener("focus", (event) => {
          borrarLabelError(event, campos, i);
        });

        campos[i].addEventListener('change', function () {
          if (this.checked) {
            borrarLabelError(event, campos, i)
          }
        });
      }

    }


    //////////////////////////////

    // validar nombre
    let patronNombreReg = /^((([a-zA-Z])+\s)*)([a-zA-Z]+$)/;
    let nombre = document.getElementById('nombre');

    function checkNombre(elm, valor) {
      let result = patronNombreReg.test(valor);
      nombre.dataset.nombre = result;
      if (!result) {
        mostrarError(nombre, "*Campo obligatorio, sin espacios al inicio o final.");
      }
    }

    nombre.addEventListener("focusout", (event) => {
      checkNombre(nombre, event.target.value);
      if (nombre.value.length == 1) {
        if (nombre.dataset.nombre) {
          if (!nombre.parentElement.parentNode.querySelector(".error")) {
            nombre.offsetParent.removeChild(elm);
          }
        }
      }
    });


    // validar Apellido
    let patronApellidoReg = /^((([a-zA-Z])+\s)*)([a-zA-Z]+$)/;
    let apellido = document.getElementById('apellido');

    function checkApellido(elm, valor) {
      let result = patronApellidoReg.test(valor);
      apellido.dataset.apellido = result;
      if (!result) {
        mostrarError(apellido, "*Campo obligatorio, sin espacios al inicio o final.");
      }
    }

    apellido.addEventListener("focusout", (event) => {
      checkApellido(apellido, event.target.value);
      if (apellido.value.length == 1) {
        if (apellido.dataset.apellido) {
          if (!apellido.parentElement.parentNode.querySelector(".error")) {
            apellido.offsetParent.removeChild(elm);
          }
        }
      }
    });


    // validar correo
    let patronEmailReg = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    let correo = document.getElementById('correo');

    function checkEmail(elm, valor) {
      let result = patronEmailReg.test(valor);
      correo.dataset.correo = result;
      if (!result) {
        mostrarError(correo, "*Correo no valido.");
      }
    }

    correo.addEventListener("focusout", (event) => {
      checkEmail(correo, event.target.value);
      if (correo.value.length == 1) {
        if (correo.dataset.correo) {
          if (!correo.parentElement.parentNode.querySelector(".error")) {
            correo.offsetParent.removeChild(elm);
          }
        }
      }
    });

    // validar Tel
    let patronTelReg = /^(?:\D*\d){10,}\D*$/;
    let telefono = document.getElementById('telefono');

    function checkTelefono(elm, valor) {
      let result = patronTelReg.test(valor);
      telefono.dataset.telefono = result;
      if (!result) {
        mostrarError(telefono, "*Mínimo 10 dígitos.");
      }
    }

    telefono.addEventListener("focusout", (event) => {
      checkTelefono(telefono, event.target.value);
      if (telefono.value.length == 1) {
        if (telefono.dataset.telefono) {
          if (!telefono.parentElement.parentNode.querySelector(".error")) {
            telefono.offsetParent.removeChild(elm);
          }
        }
      }
    });







    /////////////////////////

    function validar(evento) {
      evento.preventDefault();
      let nombre = document.getElementById('nombre');
      let apellido = document.getElementById('apellido');
      let correo = document.getElementById('correo');
      let telefono = document.getElementById('telefono');
      let sector = document.getElementById('sector');
      let autorizo = document.getElementById('autorizo');
      let estado = true;



      // validar si hay valores en los campos
      if (nombre.value.length == 0) {
        mostrarError(nombre, "*Campo obligatorio.");
        estado = false;
      }
      if (apellido.value.length == 0) {
        mostrarError(apellido, "*Campo obligatorio.");
        estado = false;
      }
      if (correo.value.length == 0) {
        mostrarError(correo, "*Campo obligatorio.");
        estado = false;
      }

      if (telefono.value.length == 0) {
        mostrarError(telefono, "*Campo obligatorio.");
        estado = false;
      }
      if (sector.value.length == 0) {
        mostrarError(sector, "*Campo obligatorio.");
        estado = false;
      }
      /*if (!autorizo.checked) {
        mostrarError(autorizo, "*Campo obligatorio.");
        estado = false;
      }*/
      if (!condiciones.checked) {
        mostrarError(condiciones, "*Campo obligatorio.");
        estado = false;
      }

      // si es correcto se envia
      if (estado) {

        if (nombre.dataset.nombre === 'true' && apellido.dataset.apellido === 'true' && correo.dataset.correo === 'true' && telefono.dataset.telefono === 'true') {
          //this.disabled = true;
          this.submit();

        }
      }
    }

    // desabilitar el boton
    /*
    let btnEnviar = document.getElementById("btn-enviar");
    btnEnviar.setAttribute("disabled", true);
    btnEnviar.classList.add("disabled");
    */
  </script>

</body>

</html>